---
description: –ö–∞—Ä—Ç–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ä–µ–¥—ã VAN QA
globs: van-qa-checks/environment-check.mdc
alwaysApply: false
---
# VAN QA: –ü–†–û–í–ï–†–ö–ê –°–†–ï–î–´

> **–ö—Ä–∞—Ç–∫–æ:** –≠—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å—Ä–µ–¥–∞ —Å–±–æ—Ä–∫–∏ —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏.

## 3Ô∏è‚É£ –ü–†–û–¶–ï–°–° –ü–†–û–í–ï–†–ö–ò –°–†–ï–î–´

```mermaid
graph TD
    Start["–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–µ–¥—ã"] --> CheckEnv["–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–µ–¥—ã —Å–±–æ—Ä–∫–∏"]
    CheckEnv --> VerifyBuildTools["–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å–±–æ—Ä–∫–∏"]
    VerifyBuildTools --> ToolsStatus{"–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∫–∏<br>–¥–æ—Å—Ç—É–ø–Ω—ã?"}
    
    ToolsStatus -->|"–î–∞"| CheckPerms["–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π<br>–∏ –¥–æ—Å—Ç—É–ø–∞"]
    ToolsStatus -->|"–ù–µ—Ç"| InstallTools["–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö<br>–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å–±–æ—Ä–∫–∏"]
    InstallTools --> RetryTools["–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞"]
    RetryTools --> ToolsStatus
    
    CheckPerms --> PermsStatus{"–†–∞–∑—Ä–µ—à–µ–Ω–∏—è<br>–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã?"}
    PermsStatus -->|"–î–∞"| EnvSuccess["–°—Ä–µ–¥–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞<br>‚úÖ –£–°–ü–ï–•"]
    PermsStatus -->|"–ù–µ—Ç"| FixPerms["–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º<br>—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏"]
    FixPerms --> RetryPerms["–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞<br>—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π"]
    RetryPerms --> PermsStatus
    
    style Start fill:#4da6ff,stroke:#0066cc,color:white
    style EnvSuccess fill:#10b981,stroke:#059669,color:white
    style ToolsStatus fill:#f6546a,stroke:#c30052,color:white
    style PermsStatus fill:#f6546a,stroke:#c30052,color:white
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ä–µ–¥—ã:
```powershell
# –ü—Ä–∏–º–µ—Ä: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–µ–¥—ã –¥–ª—è –≤–µ–±-–ø—Ä–æ–µ–∫—Ç–∞
function Validate-Environment {
    $requiredTools = @(
        @{Name = "git"; Command = "git --version"},
        @{Name = "node"; Command = "node --version"},
        @{Name = "npm"; Command = "npm --version"}
    )
    
    $missingTools = @()
    $permissionIssues = @()
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å–±–æ—Ä–∫–∏
    foreach ($tool in $requiredTools) {
        try {
            Invoke-Expression $tool.Command | Out-Null
        } catch {
            $missingTools += $tool.Name
        }
    }
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
    try {
        $testFile = ".__permission_test"
        New-Item -Path $testFile -ItemType File -Force | Out-Null
        Remove-Item -Path $testFile -Force
    } catch {
        $permissionIssues += "–¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (–æ—Ç–∫–∞–∑–∞–Ω–æ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ –Ω–∞ –∑–∞–ø–∏—Å—å)"
    }
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–∞ 3000 (–æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
    try {
        $listener = New-Object System.Net.Sockets.TcpListener([System.Net.IPAddress]::Loopback, 3000)
        $listener.Start()
        $listener.Stop()
    } catch {
        $permissionIssues += "–ü–æ—Ä—Ç 3000 (—É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–ª–∏ –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω)"
    }
    
    # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    if ($missingTools.Count -eq 0 -and $permissionIssues.Count -eq 0) {
        Write-Output "‚úÖ –°—Ä–µ–¥–∞ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞"
        return $true
    } else {
        if ($missingTools.Count -gt 0) {
            Write-Output "‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: $($missingTools -join ', ')"
        }
        if ($permissionIssues.Count -gt 0) {
            Write-Output "‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏: $($permissionIssues -join ', ')"
        }
        return $false
    }
}
```

## üìã –ö–û–ù–¢–†–û–õ–¨–ù–ê–Ø –¢–û–ß–ö–ê –ü–†–û–í–ï–†–ö–ò –°–†–ï–î–´

```
‚úì –ö–û–ù–¢–†–û–õ–¨–ù–ê–Ø –¢–û–ß–ö–ê: –ü–†–û–í–ï–†–ö–ê –°–†–ï–î–´
- –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã? [–î–ê/–ù–ï–¢]
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã? [–î–ê/–ù–ï–¢]
- –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã? [–î–ê/–ù–ï–¢]

‚Üí –ï—Å–ª–∏ –≤—Å–µ –î–ê: –ü–µ—Ä–µ–π—Ç–∏ –∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É —Ç–µ—Å—Ç—É —Å–±–æ—Ä–∫–∏.
‚Üí –ï—Å–ª–∏ –µ—Å—Ç—å –ù–ï–¢: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å—Ä–µ–¥–æ–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º.
```

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (–ø—Ä–∏ –£–°–ü–ï–•–ï):** –ó–∞–≥—Ä—É–∑–∏—Ç—å `van-qa-checks/build-test.mdc`.  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (–ø—Ä–∏ –ù–ï–£–î–ê–ß–ï):** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `van-qa-utils/common-fixes.mdc` –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å–æ —Å—Ä–µ–¥–æ–π.