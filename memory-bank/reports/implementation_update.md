# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ advanced_email_fetcher.py

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å WRD0004.jpg –∏ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ —Ñ–∞–π–ª–æ–≤

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –§–∞–π–ª `~WRD0004.jpg` –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª—Å—è, —Ö–æ—Ç—è –∏—Å—Ö–æ–¥–Ω—ã–π `WRD0004.jpg` –±—ã–ª –≤ —Å–ø–∏—Å–∫–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã –≤ –∏–º–µ–Ω–∞—Ö —Ñ–∞–π–ª–æ–≤

**–í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω `~WRD0004.jpg` –≤ —Å–ø–∏—Å–æ–∫ `specific_excluded_files`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ (~ –∏–ª–∏ .)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –≤ —Å–ø–∏—Å–∫–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```python
# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ø–æ–ª—É—á–∞–µ–º –±–∞–∑–æ–≤–æ–µ –∏–º—è –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤
base_filename = filename
if base_filename.startswith("~") or base_filename.startswith("."):
    base_filename = base_filename[1:]

# üÜï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –≤ —Å–ø–∏—Å–∫–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
if base_filename in self.specific_excluded_files:
    self.logger.info(f"üö´ –ò–°–ö–õ–Æ–ß–ï–ù–û –ü–û –ë–ê–ó–û–í–û–ú–£ –ò–ú–ï–ù–ò –§–ê–ô–õ–ê: {filename} (–±–∞–∑–∞: {base_filename})")
    self.stats['excluded_filenames'] += 1
    return { ... }
```

### 2. –£—Å–∏–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —à–∞–±–ª–æ–Ω–∞–º –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∞–≤–∏–ª–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏–∑ `attachment_filename_excludes.txt` –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å –¥–ª—è —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏
- –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Ñ–∞–π–ª—ã Sales –Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∏—Å—å, —Ö–æ—Ç—è –ø—Ä–∞–≤–∏–ª–∞ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ç–∏–≤ –ø–æ–ª–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞, –Ω–æ –∏ –ø—Ä–æ—Ç–∏–≤ –±–∞–∑–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏ –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —è–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `save_attachment_or_inline`
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

```python
# –í –º–µ—Ç–æ–¥–µ is_filename_excluded:
if fnmatch.fnmatch(filename.lower(), exclude_pattern.lower()) or \
   fnmatch.fnmatch(base_filename.lower(), exclude_pattern.lower()):
    self.logger.info(f"üö´ –§–ê–ô–õ –ò–°–ö–õ–Æ–ß–ï–ù –ü–û –ü–ê–¢–¢–ï–†–ù–£: {filename} ‚Üí {exclude_pattern}")
    return f"–∏–º—è —Ñ–∞–π–ª–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—É '{exclude_pattern}'"
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤

–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `reload_filters.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∞–≤–∏–ª –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∞–≤–∏–ª `–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è*` –∏ `Sales*` –≤ —Ñ–∞–π–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤: `python reload_filters.py`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–≥–æ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π: `python test_email_run.py`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ª–æ–≥–∞—Ö, —á—Ç–æ —Ñ–∞–π–ª—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ~WRD0004.jpg) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π –∏ Sales –Ω–µ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Ä–µ—à–∏—Ç—å –æ–±–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —É–ª—É—á—à–∏—Ç—å —Ä–∞–±–æ—Ç—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤–ª–æ–∂–µ–Ω–∏–π.
