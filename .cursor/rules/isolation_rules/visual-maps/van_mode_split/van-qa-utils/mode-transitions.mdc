---
description: Утилита для переходов между режимами VAN QA
globs: van-qa-utils/mode-transitions.mdc
alwaysApply: false
---
# VAN QA: ПЕРЕХОДЫ МЕЖДУ РЕЖИМАМИ

> **Кратко:** Этот компонент управляет переходами между режимами, в частности переходом из режима QA в режим BUILD, и предотвращает доступ к режиму BUILD без успешной валидации QA.

## 🔒 МЕХАНИЗМ ПРЕДОТВРАЩЕНИЯ ДОСТУПА К РЕЖИМУ BUILD

Система предотвращает переход в режим BUILD без прохождения валидации QA:

```mermaid
graph TD
    Start["Пользователь вводит: BUILD"] --> CheckQA{"Валидация QA<br>завершена?"}
    CheckQA -->|"Да и пройдена"| AllowBuild["Разрешить режим BUILD"]
    CheckQA -->|"Нет или провалена"| BlockBuild["БЛОКИРОВАТЬ РЕЖИМ BUILD"]
    BlockBuild --> Message["Показать:<br>⚠️ ТРЕБУЕТСЯ ВАЛИДАЦИЯ QA"]
    Message --> ReturnToVANQA["Запрос: Введите VAN QA"]
    
    style CheckQA fill:#f6546a,stroke:#c30052,color:white
    style BlockBuild fill:#ff0000,stroke:#990000,color:white,stroke-width:3px
    style Message fill:#ff5555,stroke:#dd3333,color:white
    style ReturnToVANQA fill:#4da6ff,stroke:#0066cc,color:white
```

### Пример реализации (PowerShell):
```powershell
# Проверка статуса валидации QA перед разрешением режима BUILD
function Check-QAValidationStatus {
    $qaStatusFile = "memory-bank\.qa_validation_status" # Предполагается, что статус записан в reports.mdc
    
    if (Test-Path $qaStatusFile) {
        $status = Get-Content $qaStatusFile -Raw
        if ($status -match "PASS") {
            return $true
        }
    }
    
    # Отобразить сообщение о блокировке
    Write-Output "`n`n"
    Write-Output "🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫"
    Write-Output "⛔️ РЕЖИМ BUILD ЗАБЛОКИРОВАН: ТРЕБУЕТСЯ ВАЛИДАЦИЯ QA"
    Write-Output "⛔️ Вы должны завершить валидацию QA перед переходом в режим BUILD"
    Write-Output "`n"
    Write-Output "Введите 'VAN QA' для выполнения технической валидации"
    Write-Output "`n"
    Write-Output "🚫 НИКАКАЯ РЕАЛИЗАЦИЯ НЕВОЗМОЖНА БЕЗ ВАЛИДАЦИИ 🚫"
    Write-Output "🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫🚫"
    
    return $false
}
```

## 🚨 ТРИГГЕРЫ ПЕРЕХОДА МЕЖДУ РЕЖИМАМИ

### Переход из CREATIVE в VAN QA:
После завершения фазы CREATIVE выведите это сообщение для запуска валидации QA:

```
⏭️ СЛЕДУЮЩИЙ РЕЖИМ: VAN QA
Для проверки технических требований перед реализацией введите 'VAN QA'
```

### Переход из VAN QA в BUILD (при успехе):
После успешной валидации QA выведите это сообщение для разрешения режима BUILD:

```
✅ ТЕХНИЧЕСКАЯ ВАЛИДАЦИЯ ЗАВЕРШЕНА
Все предварительные условия успешно проверены
Теперь вы можете перейти в режим BUILD
Введите 'BUILD' для начала реализации
```

### Ручной доступ к режиму BUILD (если QA уже пройдена):
Когда пользователь вручную вводит 'BUILD', проверьте статус QA перед разрешением доступа:

```powershell
# Обработка запроса на режим BUILD
function Handle-BuildModeRequest {
    if (Check-QAValidationStatus) {
        # Разрешить переход в режим BUILD
        Write-Output "`n"
        Write-Output "✅ ПРОВЕРКА ВАЛИДАЦИИ QA: ПРОЙДЕНА"
        Write-Output "Загрузка режима BUILD..."
        Write-Output "`n"
        
        # Здесь вы загрузите карту режима BUILD
        # [Code to load BUILD mode map]
        
        return $true
    }
    
    # Валидация QA не пройдена или не завершена, режим BUILD заблокирован
    return $false
}
```

**Следующий шаг (при УСПЕХЕ QA):** Продолжить в режим BUILD.
**Следующий шаг (при ПРОВАЛЕ QA):** Вернуться к процессу валидации QA.